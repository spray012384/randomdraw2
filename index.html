<!-- v 0.8.13 -->

<div class="title-with-version">
  <h1>🎯 뽑기판 설정</h1>
  <span class="version-label">v 0.8.13</span>
</div>

<div class="main-setting-container">
  <!-- 상품 안내 비활성화 (자동 처리됨) -->

  <div class="row">
    <label for="horizontal">가로</label>
    <input type="number" id="horizontal" min="1" max="10" value="3">
  </div>

  <div class="row">
    <label for="vertical">세로</label>
    <input type="number" id="vertical" min="1" max="10" value="3">
  </div>

  <div class="row">
    <label for="total">당첨 개수</label>
    <input type="number" id="total" min="1" value="1">
    <span class="error-text" id="total-error"></span>
  </div>

  <div class="row">
    <label>당첨 위치 설정</label>
    <div class="button-group" id="position-type-group">
      <button type="button" id="random-position" class="selected">랜덤 지정</button>
      <button type="button" id="manual-position">직접 지정</button>
    </div>
  </div>

  <div id="manual-input-fields"></div>

  <div class="row">
    <button class="start-button">시작하기</button>
    <button class="save-button">저장하기</button>
    <button class="reset-button">초기화</button>
  </div>
</div>

<div class="footer-version">v 0.8.13</div>

<script>
const horizontalInput = document.getElementById('horizontal');
const verticalInput = document.getElementById('vertical');
const totalInput = document.getElementById('total');
const totalErrorText = document.getElementById('total-error');

const positionTypeGroup = document.getElementById('position-type-group');
const manualInputFields = document.getElementById('manual-input-fields');

const manualPositionButton = document.getElementById('manual-position');
const randomPositionButton = document.getElementById('random-position');

let isManualPosition = false;

manualPositionButton.addEventListener('click', () => {
  isManualPosition = true;
  manualPositionButton.classList.add('selected');
  randomPositionButton.classList.remove('selected');
  renderManualPositionInputs();
});

randomPositionButton.addEventListener('click', () => {
  isManualPosition = false;
  randomPositionButton.classList.add('selected');
  manualPositionButton.classList.remove('selected');
  manualInputFields.innerHTML = '';
});

function validateTotalInput() {
  const h = parseInt(horizontalInput.value);
  const v = parseInt(verticalInput.value);
  const total = parseInt(totalInput.value);

  if (!h || !v || !total) {
    totalErrorText.textContent = '[가로, 세로, 당첨개수를 입력해주세요.]';
    return false;
  }

  const maxAllowed = h * v - 1;
  if (total > maxAllowed) {
    totalErrorText.textContent = `[당첨 개수는 최대 ${maxAllowed}개까지 가능합니다.]`;
    return false;
  }

  totalErrorText.textContent = '';
  return true;
}

[horizontalInput, verticalInput, totalInput].forEach(input => {
  input.addEventListener('input', validateTotalInput);
});

function renderManualPositionInputs() {
  if (!validateTotalInput()) return;

  const h = parseInt(horizontalInput.value);
  const v = parseInt(verticalInput.value);
  const total = parseInt(totalInput.value);

  manualInputFields.innerHTML = '';
  const title = document.createElement('div');
  title.innerHTML = '<strong>[직접 당첨 위치를 입력하세요]</strong>';
  manualInputFields.appendChild(title);

  for (let i = 0; i < total; i++) {
    const row = document.createElement('div');
    row.className = 'manual-input-row';

    const label = document.createElement('label');
    label.textContent = `${i + 1}번 위치`;

    const input = document.createElement('input');
    input.type = 'text';
    input.placeholder = '예: 1,2 (가로1, 세로2)';
    input.name = `manual-position-${i}`;

    row.appendChild(label);
    row.appendChild(input);
    manualInputFields.appendChild(row);
  }
}
</script>

<!-- v 0.8.13 -->
