<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>뽑기판 설정 v1.3.9</title>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6" x-data="lotteryApp">
  <div class="max-w-3xl mx-auto bg-white p-6 rounded-2xl shadow-xl space-y-4">
    <h1 class="text-3xl font-bold text-center">뽑기판 설정</h1>

    <div>
      <label class="block font-semibold mb-1">메인 타이틀</label>
      <input type="text" x-model="mainTitle" class="w-full border p-2 rounded"/>
    </div>

    <div>
      <label class="block font-semibold mb-1">서브 타이틀</label>
      <input type="text" x-model="subTitle" class="w-full border p-2 rounded"/>
    </div>

    <div class="grid grid-cols-3 gap-4">
      <div>
        <label class="block font-semibold mb-1">세로 (행)</label>
        <input type="number" min="1" max="10" x-model.number="rows" @input="validateWinners" class="w-full border p-2 rounded"/>
      </div>
      <div>
        <label class="block font-semibold mb-1">가로 (열)</label>
        <input type="number" min="1" max="10" x-model.number="cols" @input="validateWinners" class="w-full border p-2 rounded"/>
      </div>
      <div>
        <label class="block font-semibold mb-1">당첨 개수</label>
        <input type="number" :max="maxWinners" min="1" x-model.number="winners" class="w-full border p-2 rounded"/>
        <p class="text-sm text-gray-500 mt-1">최대: {{ maxWinners }}</p>
      </div>
    </div>

    <div>
      <label class="block font-semibold mb-1">당첨 방식</label>
      <select x-model="winMode" class="w-full border p-2 rounded">
        <option value="default">기본 (꽝/당첨)</option>
        <option value="text">직접 텍스트 입력</option>
      </select>
    </div>

    <div>
      <label class="block font-semibold mb-1">셀 UI 설정</label>
      <select x-model="cellUI" class="w-full border p-2 rounded">
        <option value="basic">기본</option>
        <option value="text">텍스트 직접 입력</option>
        <option value="image">이미지 업로드</option>
      </select>
    </div>

    <div class="flex justify-between mt-6 space-x-2">
      <button class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700" @click="startGame()">시작하기</button>
      <button class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600" @click="saveSettings()">저장하기</button>
      <button class="bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500" @click="reset()">초기화하기</button>
    </div>
  </div>

  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('lotteryApp', () => ({
        mainTitle: '',
        subTitle: '',
        rows: 3,
        cols: 3,
        winners: 1,
        winMode: 'default',
        cellUI: 'basic',

        get maxWinners() {
          return Math.max(1, this.rows * this.cols - 1);
        },

        validateWinners() {
          if (this.winners > this.maxWinners) {
            this.winners = this.maxWinners;
          }
        },

        startGame() {
          const settings = this.collectSettings();
          window.open('game.html?data=' + encodeURIComponent(JSON.stringify(settings)), '_blank');
        },

        saveSettings() {
          alert('설정이 저장되었습니다!');
          console.log(this.collectSettings());
        },

        reset() {
          this.mainTitle = '';
          this.subTitle = '';
          this.rows = 3;
          this.cols = 3;
          this.winners = 1;
          this.winMode = 'default';
          this.cellUI = 'basic';
        },

        collectSettings() {
          return {
            mainTitle: this.mainTitle,
            subTitle: this.subTitle,
            rows: this.rows,
            cols: this.cols,
            winners: this.winners,
            winMode: this.winMode,
            cellUI: this.cellUI
          };
        }
      }));
    });
  </script>
</body>
</html>
